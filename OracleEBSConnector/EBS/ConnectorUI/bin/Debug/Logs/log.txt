INFO  [2019-08-31 14:31:46,088] [ConnectorUI.Connector+<start>d__4] ********************************************************************************************************************
INFO  [2019-08-31 14:31:46,114] [ConnectorUI.Connector+<start>d__4] Company Name : Magic Oracle EBS 
INFO  [2019-08-31 14:32:03,473] [ConnectorUI.Connector+<start>d__4] Magic Oracle EBS Sync started..
INFO  [2019-08-31 14:32:03,518] [ConnectorUI.Connector+<start>d__4] Retrieved Connector Config ...
INFO  [2019-08-31 14:34:33,172] [ConnectorUI.Connector+<SendRequestEBSToMT>d__5] Get data from database for 'PURCHASE_ORDER' Query 
INFO  [2019-08-31 14:34:34,070] [ConnectorUI.Connector+<GetApiResult>d__6] LASTSYNC FROM CONNECTOR :: 1970-01-01 05:30:00
INFO  [2019-08-31 14:34:35,339] [EBS.ODBCDataAccess+<GetResult>d__9] commandText afer lastsync replace ::  SELECT  a.PO_HEADER_ID , a.VENDOR_ID,  a.TERMS_ID, a.SEGMENT1 as PO_NUM, a.AUTHORIZATION_STATUS, a.TYPE_LOOKUP_CODE as PO_TYPE,
b.ITEM_DESCRIPTION, b.QUANTITY, c.QUANTITY_RECEIVED, c.QUANTITY_BILLED, c.DESCRIPTION as LINE_LOCATION_DESCP, b.UNIT_PRICE as ITEM_AMOUNT, 
b.LINE_NUM ,
b.CLOSED_DATE, c.AMOUNT_RECEIVED ,c.AMOUNT_BILLED, e.SEGMENT1 as ITEM_NAME, b.ITEM_ID, (b.QUANTITY * b.UNIT_PRICE) as AMOUNT,
a.creation_date, b.PO_LINE_ID,  b.LIST_PRICE_PER_UNIT, c.LINE_LOCATION_ID, c.CLOSED_FLAG,  d.VENDOR_NAME, c.NEED_BY_DATE,
TO_CHAR(
GREATEST( 
COALESCE( (cast(a.LAST_UPDATE_DATE as TIMESTAMP)), (cast(b.LAST_UPDATE_DATE as TIMESTAMP)), (cast(c.LAST_UPDATE_DATE as TIMESTAMP)) ),
COALESCE( (cast(c.LAST_UPDATE_DATE as TIMESTAMP)), (cast(a.LAST_UPDATE_DATE as TIMESTAMP)), (cast(b.LAST_UPDATE_DATE as TIMESTAMP)) ),
COALESCE( (cast(b.LAST_UPDATE_DATE as TIMESTAMP)), (cast(c.LAST_UPDATE_DATE as TIMESTAMP)), (cast(a.LAST_UPDATE_DATE as TIMESTAMP)) )
),'YYYY-MM-DD HH24:MI:SS') as LAST_UPDATE_DATE 
FROM  apps.PO_HEADERS_ALL a
LEFT JOIN  apps.PO_LINES_ALL b
     ON a.PO_HEADER_ID = b.PO_HEADER_ID
LEFT  JOIN apps.PO_LINE_LOCATIONS_ALL c
    ON b.PO_LINE_ID = c.PO_LINE_ID
INNER  JOIN  AP.AP_SUPPLIERS d
    ON a.VENDOR_ID = d.VENDOR_ID
INNER  JOIN INV.MTL_SYSTEM_ITEMS_B e
    ON  e.ORGANIZATION_ID = b.ORG_ID  and b.ITEM_ID = e.INVENTORY_ITEM_ID
 where TO_CHAR(
GREATEST( 
COALESCE( (cast(a.LAST_UPDATE_DATE as TIMESTAMP)), (cast(b.LAST_UPDATE_DATE as TIMESTAMP)), (cast(c.LAST_UPDATE_DATE as TIMESTAMP)) ),
COALESCE( (cast(c.LAST_UPDATE_DATE as TIMESTAMP)), (cast(a.LAST_UPDATE_DATE as TIMESTAMP)), (cast(b.LAST_UPDATE_DATE as TIMESTAMP)) ),
COALESCE( (cast(b.LAST_UPDATE_DATE as TIMESTAMP)), (cast(c.LAST_UPDATE_DATE as TIMESTAMP)), (cast(a.LAST_UPDATE_DATE as TIMESTAMP)) )
),'YYYY-MM-DD HH24:MI:SS') > '1970-01-01 05:30:00' and rownum <= 50
 ORDER BY  a.PO_HEADER_ID , LAST_UPDATE_DATE asc 
